/*
 * Copyright (c) 2024 kodomari
 * SPDX-License-Identifier: MIT
 */

#include "kod_04.dtsi"

&xiao_spi { status = "disabled"; };
&xiao_i2c { status = "disabled"; };
&xiao_serial { status = "disabled"; };

/ {
    kscan0: kscan {
        compatible = "zmk,kscan-gpio-matrix";
        wakeup-source;
        diode-direction = "col2row";
        
        // 5行（実際の配線通り）
        row-gpios
            = <&xiao_d 3 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>   // 行0: D3
            , <&xiao_d 9 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>   // 行1: D9
            , <&gpio1 7 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>    // 行2: P1.07 (カステレーテッド)
            , <&xiao_d 10 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>  // 行3: D10
            , <&xiao_d 4 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>   // 行4: D4
            ;
        
        // 7列（実際の配線通り）
        col-gpios
            = <&gpio1 5 GPIO_ACTIVE_HIGH>  // 列0: P1.05 (カステレーテッド)
            , <&xiao_d 8 GPIO_ACTIVE_HIGH> // 列1: D8
            , <&gpio1 3 GPIO_ACTIVE_HIGH>  // 列2: P1.03 (カステレーテッド)
            , <&xiao_d 7 GPIO_ACTIVE_HIGH> // 列3: D7
            , <&xiao_d 2 GPIO_ACTIVE_HIGH> // 列4: D2
            , <&xiao_d 1 GPIO_ACTIVE_HIGH> // 列5: D1
            , <&xiao_d 0 GPIO_ACTIVE_HIGH> // 列6: D0
            ;
    };
};

// トラックポイントはコメントアウト（後で追加）
// &input_ps2 {
//     status = "okay";
//     scl-gpios = <&gpio0 XX GPIO_ACTIVE_HIGH>;  // CLK (後で決定)
//     sda-gpios = <&gpio0 YY GPIO_ACTIVE_HIGH>;  // DATA (後で決定)
// };
